{"version":3,"sources":["src/tetromino.js"],"names":[],"mappings":"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","file":"tetromino.js","sourcesContent":["export default class Tetromino {\n\n    constructor(config, ctx) {\n        this.config = config;\n        this.ctx = ctx;\n\n        // create a random shape based on modules\n        const modules = Tetromino.modules;\n        this.type = Math.floor(Math.random() * modules.length);\n        this.shape = Math.floor(Math.random() * modules[this.type].shape.length);\n\n        this._initCoordinates();\n    }\n\n    _initCoordinates() {\n        this.mapX = Math.floor(this.config.columns / 2);\n        this.mapY = -1;\n        if (this.type == 0 || this.type == 1 && this.shape == 1 || this.type == 4 && this.shape == 1 || this.type == 5 && this.shape == 3 || this.type == 6 && this.shape == 0) {\n            // no blocks below the core block\n            this.mapY = 0;\n        }\n    }\n\n    getNextShape() {\n        return (this.shape + 1) % Tetromino.modules[this.type].shape.length;\n    }\n\n    setShape(shape) {\n        shape = shape || 0;\n\n        this.shape = shape;\n    }\n\n    draw(x, y) {\n        x = x || this.mapX;\n        y = y || this.mapY;\n\n        const s = Tetromino.modules[this.type].shape[this.shape];\n        const size = this.config.tetrominoSize;\n        const color = this.getColor();\n        for (let i = 0; i < s.length; i++) {\n            const blockY = y + s[i][1];\n            if (blockY >= 0) {\n                // in map area\n                this.drawBlock(color, (x + s[i][0]) * size, blockY * size);\n            }\n        }\n    }\n\n    drawOutline(positions) {\n        if (positions === undefined) {\n            return;\n        }\n\n        const size = this.config.tetrominoSize;\n        const color = this.getColor();\n        for (let i = 0; i < positions.length; i++) {\n            const blockY = positions[i][1];\n            if (blockY >= 0) {\n                // in map area\n                this.drawBlockOutline(color, positions[i][0] * size, blockY * size);\n            }\n        }\n    }\n\n    getShapePosition(shape, offsetX, offsetY) {\n        if (shape === null || shape === undefined) {\n            shape = this.shape;\n        }\n\n        offsetX = offsetX || 0;\n        offsetY = offsetY || 0;\n\n        const positions = [];\n        const s = Tetromino.modules[this.type].shape[shape];\n\n        for (let i = 0; i < s.length; i++) {\n            let x = this.mapX + s[i][0] + offsetX;\n            let y = this.mapY + s[i][1] + offsetY;\n            y = y < 0 ? 0 : y;\n\n            positions.push([x, y]);\n        }\n\n        return positions;\n    }\n\n    move(offsetX, offsetY) {\n        offsetX = offsetX || 0;\n        offsetY = offsetY || 0;\n\n        this.mapX += offsetX;\n        this.mapY += offsetY;\n    }\n\n    getColor() {\n        return Tetromino.modules[this.type].color;\n    }\n\n    drawBlockOutline(color, x, y) {\n        const ctx = this.ctx;\n        const size = this.config.tetrominoSize;\n        const lineWidth = 6;\n\n        ctx.lineWidth = lineWidth;\n        ctx.strokeStyle = color;\n        ctx.strokeRect(x + lineWidth, y + lineWidth, size - lineWidth * 2, size - lineWidth * 2);\n        // return line width to normal\n        ctx.lineWidth = 1;\n    }\n\n    drawBlock(color, x, y) {\n        const ctx = this.ctx;\n        const size = this.config.tetrominoSize;\n        const centerSize = Math.round(size * 0.6);\n        const gap = Math.ceil((size - centerSize) / 2);\n        const colorLuminance = Tetromino.colorLuminance;\n\n        // border top\n        ctx.beginPath();\n        ctx.fillStyle = colorLuminance(color, .6);\n        ctx.moveTo(x, y);\n        ctx.lineTo(x + gap, y + gap);\n        ctx.lineTo(x + size - gap, y + gap);\n        ctx.lineTo(x + size, y);\n        ctx.closePath();\n        ctx.fill();\n\n        // border top left gap\n        ctx.beginPath();\n        ctx.strokeStyle = colorLuminance(color, .6);\n        ctx.moveTo(x, y);\n        ctx.lineTo(x + gap, y + gap);\n        ctx.closePath();\n        ctx.stroke();\n\n        // border top right gap\n        ctx.beginPath();\n        ctx.strokeStyle = colorLuminance(color, .6);\n        ctx.moveTo(x + size, y);\n        ctx.lineTo(x + size - gap, y + gap);\n        ctx.closePath();\n        ctx.stroke();\n\n        // border left\n        ctx.beginPath();\n        ctx.fillStyle = colorLuminance(color, .4);\n        ctx.moveTo(x, y);\n        ctx.lineTo(x + gap, y + gap);\n        ctx.lineTo(x + gap, y + size - gap);\n        ctx.lineTo(x, y + size);\n        ctx.closePath();\n        ctx.fill();\n\n        // border right\n        ctx.beginPath();\n        ctx.fillStyle = colorLuminance(color, -.2);\n        ctx.moveTo(x + size, y);\n        ctx.lineTo(x + size - gap, y + gap);\n        ctx.lineTo(x + size - gap, y + size - gap);\n        ctx.lineTo(x + size, y + size);\n        ctx.closePath();\n        ctx.fill();\n\n        // border bottom\n        ctx.beginPath();\n        ctx.fillStyle = colorLuminance(color, -.4);\n        ctx.moveTo(x, y + size);\n        ctx.lineTo(x + gap, y + size - gap);\n        ctx.lineTo(x + size - gap, y + size - gap);\n        ctx.lineTo(x + size, y + size);\n        ctx.closePath();\n        ctx.fill();\n\n        // border bottom left gap\n        ctx.beginPath();\n        ctx.strokeStyle = colorLuminance(color, -.4);\n        ctx.moveTo(x, y + size);\n        ctx.lineTo(x + gap, y + size - gap);\n        ctx.closePath();\n        ctx.stroke();\n\n        // border bottom right gap\n        ctx.beginPath();\n        ctx.strokeStyle = colorLuminance(color, -.4);\n        ctx.moveTo(x + size, y + size);\n        ctx.lineTo(x + size - gap, y + size - gap);\n        ctx.closePath();\n        ctx.stroke();\n\n        // center rect\n        ctx.fillStyle = color;\n        ctx.fillRect(x + gap, y + gap, centerSize, centerSize)\n    }\n\n    /**\n     * to make a hex color lighter or darker\n     * @param hex, the original hex color(e.g. `f00`, `ff1211`, `#232`, `#232323`)\n     * @param lum, a number between -1 and 1 to make color lighter(positive) or darker(negative)\n     * @returns {string} the result hex color include `#`\n     */\n    static colorLuminance(hex, lum) {\n        // validate hex string\n        hex = String(hex).replace(/[^0-9a-f]/gi, '');\n        if (hex.length < 6) {\n            hex = hex[0] + hex[0] + hex[1] + hex[1] + hex[2] + hex[2];\n        }\n        lum = lum || 0;\n\n        // convert to decimal and change luminosity\n        var rgb = \"#\", c, i;\n        for (i = 0; i < 3; i++) {\n            c = parseInt(hex.substr(i * 2, 2), 16);\n            c = Math.round(Math.min(Math.max(0, c + (c * lum)), 255)).toString(16);\n            rgb += (\"00\" + c).substr(c.length);\n        }\n\n        return rgb;\n    }\n\n    save(key) {\n        key = key || 'TetrisTetromino';\n        const t = {type: this.type, shape: this.shape};\n        localStorage[key] = JSON.stringify(t);\n    }\n\n    load(key) {\n        key = key || 'TetrisTetromino';\n        const t = JSON.parse(localStorage[key]);\n        this.type = parseInt(t.type);\n        this.shape = parseInt(t.shape);\n        this._initCoordinates();\n    }\n}\n\n// see all modules design in README.md\nTetromino.modules = [];\n\nconst O = {};\nO.shape = [];\nO.shape.push([[-1, -1], [0, -1], [-1, 0], [0, 0]]);\nO.color = '#ff0';// yellow\nTetromino.modules.push(O);\n\nconst I = {};\nI.shape = [];\nI.shape.push([[0, -2], [0, -1], [0, 0], [0, 1]]);\nI.shape.push([[-2, 0], [-1, 0], [0, 0], [1, 0]]);\nI.color = '#0ff';// cyan\nTetromino.modules.push(I);\n\nconst S = {};\nS.shape = [];\nS.shape.push([[-1, -1], [-1, 0], [0, 0], [0, 1]]);\nS.shape.push([[0, -1], [1, -1], [-1, 0], [0, 0]]);\nS.color = '#80ff00';// lime\nTetromino.modules.push(S);\n\nconst Z = {};\nZ.shape = [];\nZ.shape.push([[0, -1], [-1, 0], [0, 0], [-1, 1]]);\nZ.shape.push([[-1, -1], [0, -1], [0, 0], [1, 0]]);\nZ.color = '#f00';// red\nTetromino.modules.push(Z);\n\nconst L = {};\nL.shape = [];\nL.shape.push([[-1, -1], [0, -1], [0, 0], [0, 1]]);\nL.shape.push([[1, -1], [-1, 0], [0, 0], [1, 0]]);\nL.shape.push([[0, -1], [0, 0], [0, 1], [1, 1]]);\nL.shape.push([[-1, 0], [0, 0], [1, 0], [-1, 1]]);\nL.color = '#ffa500';// orange\nTetromino.modules.push(L);\n\nconst J = {};\nJ.shape = [];\nJ.shape.push([[0, -1], [1, -1], [0, 0], [0, 1]]);\nJ.shape.push([[-1, 0], [0, 0], [1, 0], [1, 1]]);\nJ.shape.push([[0, -1], [0, 0], [-1, 1], [0, 1]]);\nJ.shape.push([[-1, -1], [-1, 0], [0, 0], [1, 0]]);\nJ.color = '#00f';// blue\nTetromino.modules.push(J);\n\nconst T = {};\nT.shape = [];\nT.shape.push([[0, -1], [-1, 0], [0, 0], [1, 0]]);\nT.shape.push([[0, -1], [0, 0], [1, 0], [0, 1]]);\nT.shape.push([[-1, 0], [0, 0], [1, 0], [0, 1]]);\nT.shape.push([[0, -1], [-1, 0], [0, 0], [0, 1]]);\nT.color = '#800080';// purple\nTetromino.modules.push(T);"]}